## String

### 创建方式

> 引号创建`String a = "a"`

- 在方法区的字符串池中，创建字符串常量
- 引用指向字符串常量

> new创建（不推荐使用）`String a = new String("a")`

- 首先查看字符串池中是否有相同值的字符串
- 如果池中没有，则在字符串池中创建字符串常量
- 在堆中新建一个String实例，该实例指向字符串常量
- 引用指向堆中的String实例

### 字符型常量和字符串常量的区别

- 形式上：字符常量是`单引号`引起的`一个`字符; 字符串常量是`双引号`引起的`若干个`字符
- 含义上：字符常量相当于一个`整型值`( ASCII 值),可以参加表达式运算; 字符串常量代表一个`地址值`(该字符串在内存中存放位置)
- 占内存大小：字符常量只占` 2 个字节`; 字符串常量占`若干个字节` (**注意： char 在 Java 中占两个字节**)


### 大量使用连接符+的问题

- 创建大量临时的StringBuilder对象，对字符串进行append操作
- 每次append操作完成后，调用toString方法将其转换成字符串
- 会频繁触发young gc

## 区别

### 可变性
- 使用 final 关键字修饰字符数组来保存字符串，`private final char value[]`，所以 String 对象是`不可变`的
- 而 StringBuilder 与 StringBuffer 都继承自 AbstractStringBuilder 类，在 AbstractStringBuilder 中也是使用字符数组保存字符串`char[]value` 但是没有用 final 关键字修饰，所以这两种对象都是`可变`的
> 在 Java 9 之后，String 类的实现改用 byte 数组存储字符串 `private final byte[] value`

### 线程安全性

- String 中的对象是不可变的，也就可以理解为`常量`，`线程安全`
- StringBuffer 对方法加了同步锁或者对调用的方法加了同步锁，所以是`线程安全`的
- StringBuilder 并没有对方法进行加同步锁，所以是`非线程安全`的
> AbstractStringBuilder 是 StringBuilder 与 StringBuffer 的公共父类，定义了一些字符串的基本操作，如 expandCapacity、append、insert、indexOf 等公共方法

### 性能

- 每次对 String 类型进行改变的时候，都会生成一个新的 String 对象，然后将指针指向新的 String 对象
- StringBuffer 每次都会对 StringBuffer 对象本身进行操作，而不是生成新的对象并改变对象引用
- 相同情况下使用 StringBuilder 相比使用 StringBuffer 仅能获得 10%~15% 左右的性能提升，但却要冒多线程不安全的风险

## 对于三者使用的总结

- 操作少量的数据: 适用 String
- 单线程操作字符串缓冲区下操作大量数据: 适用 StringBuilder
- 多线程操作字符串缓冲区下操作大量数据: 适用 StringBuffer